<!DOCTYPE html>
<script type="text/javascript">
    if(sessionStorage.getItem("authorization") == null  || sessionStorage.getItem("authorization") == 'false'){
        location.href = 'login.html';
    }
</script>

<html> 
    <head>
        <!-- SEMPRE MANTER ATUALIZADO COM O LAYOUT DO RENDER !!!  -->
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" type="text/css" href="css/reset.css" />
        <link rel="stylesheet" type="text/css" href="css/print.css" media="print" />
        <link rel="stylesheet" type="text/css" href="css/render/render.css">
        <link rel="stylesheet" type="text/css" href="css/reset.css">
        <link rel="stylesheet" type="text/css" href="css/render/global.css">
        <link rel="stylesheet" type="text/css" href="css/render/meet.css">
        <link rel="stylesheet" type="text/css" href="css/render/fonts.css">
        <!---[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="<?php echo Yii::app()->theme->baseUrl; ?>/css/ie.css" media="screen, projection" />
        <![endif]-->
        <script src="js/jquery/jquery-1.7.2.js"></script>
        <script src="js/jquery/jquery.ui.core.js"></script>
        <script src="js/jquery/jquery.ui.widget.js"></script>
        <script src="js/jquery/jquery.ui.mouse.js"></script>
        <script src="js/jquery/jquery.ui.draggable.js"></script>
        <script src="js/jquery/jquery.ui.droppable.js"></script>
        <script type="text/javascript" src="js/render/meet.js"></script>
        <script type="text/javascript" src="js/render/domcobject.js"></script>
        <script type="text/javascript" src="js/jquery.shuffle.js"></script>
        <!-- Abrir Script do renderDB --> 
        <script type="text/javascript" src="db/renderDB.js"></script>
        <script>
    
            $(document).ready(function(){
                if (window.openDatabase) {
                    console.log("Suporta BD-HTML5");
                }
        
                //Iniciar Encontro
                var personage = '';
                var idActor = '';
                var unityIdActor = '';
                //===========================================
                var unityfather = ''; 
                var org = ''; 
                var classe = ''; 
        
                //var unityfather_name = ''; 
                var org_name = ''; 
                var classe_name = ''; 
          
                var options = {
                    org: [org,org_name],
                    classe: [classe,classe_name],
                    actor: [sessionStorage.getItem('id_actor'),sessionStorage.getItem('name_actor')]
                };
         
                //Passar parâmetro do tipo do Encontro
                var newMeet = new Meet(unityfather,options);
        
                $('#head_meet').append(newMeet.headMeet());
                
                var block_id = '1';
                var cobjectsFromBlock = null;
                //Obter todos os Cobject deste Bloco
                var getcobjectsFromBlock =  newMeet.DB_synapse.getCobjectsFromBlock(block_id, function(objectsThisBlock){
                    
                    //count do número de objetos
                    var num_objects = 0;
                    $.each(objectsThisBlock, function(){
                        num_objects++;
                    });
                    
                    $.each(objectsThisBlock, function(idx, object){
                        //Para cada Cobject Cria sua Dom
                        newMeet.DB_synapse.getCobject(object, function(json_cobject){
                            var dump = new DomCobject(json_cobject,idx);
                            //Adicionar o domCobjets no Encontro 'Meet'
                            newMeet.pushDomCobjects(dump);
                            //Chamar função para inserir nome html
                            if(idx == num_objects-1){
                                $('#render_canvas').html(newMeet.domCobjectBuildAll());
                                  newMeet.beginEvents();
                                //Após criar o DomCobject no Dom 
                                // Render Ready! 
                            }
                            
                        });
                    });
    
                    
                });
                    
               
                
                //Atualizar O painel do render
                $('.info.info-name').html('<p>'+newMeet.actor_name+'</p>');
                $('.info.info-hits .info-text').html(newMeet.peformance_qtd_correct);
                $('.info.info-erros .info-text').html(newMeet.peformance_qtd_wrong); 

                //Mostrar/Ocultar barra de informações
                $('#info-button').click(function() {
                    if ($('#head_meet').is(':visible')) {
                        $('#head_meet').hide();
                        $('#info-button').css('left','0');
                    } else {
                        $('#head_meet').show();
                        $('#info-button').css('left','156px');
                    }
                });

            });
    
        </script>
        <title>Render</title>
    </head>
    <body id="synapse">

        <!-- Barra de informações -->
        <div id="head_meet">
            <div class="info info-name">

            </div>
            <div class="info info-time">
                <img class="info-icon" src="img/icons/clock.png">
                <p class="info-text">00:00:45</p>
                <div class="clear"></div>
            </div>
            <div class="info info-hits">
                <img class="info-icon" src="img/icons/hit.png">
                <p class="info-text"></p>
                <div class="clear"></div>
            </div>
            <div class="info info-erros">
                <img class="info-icon" src="img/icons/error.png">
                <p class="info-text"></p>
                <div class="clear"></div>
            </div>
            <a class="info-exit" href="#">
                <img class="info-icon" src="img/icons/exit.png">
                <p class="info-text">encerrar atendimento</p>
                <div class="clear"></div>
            </a>
        </div>

        <div id="info-button">
            <img class="info-icon" src="img/icons/exit.png">
        </div>

        <div id="message"> 
        </div>
        <div id="render_canvas">
        </div>
    </body>
</html>

